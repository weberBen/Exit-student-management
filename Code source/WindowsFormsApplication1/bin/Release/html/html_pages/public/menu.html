
<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="Expires" content="0">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Cache-Control" content="no-cache">
  <title>App gestion des déplacements d'élèves</title>
  <meta name="generator" content="Google Web Designer 4.2.0.0802">
  <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
  <link rel="icon" href="images.ashx?im=icon.ico">
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <script src="javascriptFile.ashx?javascriptFile=global_script.js"></script>
  <script src="javascriptFile.ashx?javascriptFile=account_verification_script.js"></script>
  <style type="text/css" id="gwd-text-style">
    p {
      margin: 0px;
    }
    h1 {
      margin: 0px;
    }
    h2 {
      margin: 0px;
    }
    h3 {
      margin: 0px;
    }
  </style>
  <style type="text/css">
    html, body {
      width: 100%;
      height: 100%;
      margin: 0px;
    }
    body {
      transform: perspective(1400px) matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);
      transform-style: preserve-3d;
    }
    .main-color-theme {
      background-color: rgb(58, 175, 169);
    }
    .main-font-theme {
      color: rgb(255, 255, 255);
      font-family: Bevan, cursive;
    }
    .secondary-font-theme {
      color: rgb(33, 92, 89);
      font-family: Bevan, cursive;
    }
    .menu-gwd-span-1k1n {
      height: 10%;
      left: 7%;
      top: 90%;
    }
    .menu-gwd-img-1lld {
      position: absolute;
      background-image: none;
      background-color: rgb(33, 92, 89);
      top: 0%;
      width: 16.99%;
      transform-origin: 72.5485px 332.759px 0px;
      height: 100%;
      left: 83%;
    }
    .menu-gwd-img-77n8 {
      position: absolute;
      height: 20.69%;
      transform-origin: 291.736px 50.8785px 0px;
      left: 19%;
      top: 3%;
      width: 55%;
    }
    .menu-gwd-span-v8zs {
      position: absolute;
      font-size: 120%;
      text-align: center;
      width: 13.97%;
      height: 5.93%;
      transform-origin: 24.385px 31.4883px 0px;
      top: 35%;
      left: 84%;
    }
    .menu-gwd-img-1hc6 {
      position: absolute;
      height: 20.69%;
      width: 60.93%;
      transform-origin: 281.181px 51.8599px 0px;
      top: 36%;
      left: 21%;
    }
    .menu-gwd-span-1sbk {
      left: 0.66%;
      top: 58.96%;
      width: 99.35%;
      height: 5.86%;
      transform-origin: 74.6648px 16.9782px 0px;
    }
    .menu-gwd-img-1g2x {
      position: absolute;
      height: 20.34%;
      width: 59.61%;
      transform-origin: 271.404px 51.333px 0px;
      left: 22%;
      top: 73%;
    }
    .menu-gwd-img-10ek {
      transform-origin: 17.254px 17px 0px;
      top: 38.5%;
    }
    .menu-gwd-div-1kb8 {
      position: absolute;
      height: 86.79%;
      width: 82.84%;
      transform-origin: 366.038px 290.003px 0px;
      left: 0px;
      top: 86px;
    }
    .menu-gwd-div-eeuw {
      position: fixed;
      left: 82.9%;
      top: 12.86%;
      height: 86.7%;
      width: 17.1%;
    }
    .menu-gwd-span-unrd {
      width: 98.02%;
      height: 5.34%;
      transform-origin: 170.829px 28.1997px 0px;
      left: 1.32%;
      top: 26.03%;
    }
    .menu-gwd-span-unrd {
      transform-origin: 71.0156px 0px 0px;
    }
    .menu-gwd-img-77n8 {
      transform-origin: -308.672px 149.063px 0px;
      top: 3%;
      left: 23%;
    }
    .menu-gwd-div-eeuw {
      top: 13%;
      left: 83%;
      transform-origin: 75.008px 247.531px 0px;
    }
    .menu-gwd-div-i075 {
      position: absolute;
      transform-style: preserve-3d;
      left: 0%;
      top: 0%;
      border: none;
      height: 87%;
      transform: translate3d(0px, 87px, 0px) rotateZ(0.0610656deg);
      width: 83.01%;
      transform-origin: 368.078px 290.266px 0px;
    }
    .gwd-div-1b4f {
      position: absolute;
      transform-origin: 366.35px 43.3649px 0px;
      top: 0%;
      left: 0%;
      width: 83.01%;
      height: 13%;
    }
    .gwd-div-1our {
      font-size: 80%;
      text-align: center;
      position: absolute;
      left: 83.01%;
      top: 0%;
      width: 16.99%;
      height: 13%;
      transform-origin: 74.9521px 43.4838px 0px;
    }
  </style>
</head>

<body class="htmlNoPages main-color-theme" onload="MainMenu.initialize()">
  <script>
    var MainMenu = (

      function() { //all these functions that allow direct modification of the list are only availabe in the module "AuthorizedExit", not outside
        var current_session_info = "";
        var number_content_to_load = 0;
        var number_content_loaded = 0;


        function disconnectionArrayMouseOver() {
          current_session_info = document.getElementById("display_session_info_span").innerText;
          document.getElementById("display_session_info_span").innerText = "Déconnexion";
          document.getElementById("display_session_info_span").style.backgroundColor = "#ff8080";

        }

        function disconnectionArrayMouseOut() {
          document.getElementById("display_session_info_span").innerText = current_session_info;
          document.getElementById("display_session_info_span").style.backgroundColor = "transparent";
        }

        function disconnectionArrayClick() {
          DataRequest.sendPostRequest(DataRequest.setDisconnectionFromSession(), setChange);
        }


        function loadMaiScript(source) {

          DataRequest.loadScript(document.body, "content_script", source);
        }

        function reset() {
          try {
            destroy();
          } catch (e) {}
          /* function in each javascript that delete from memory all listner added and variable
           * If the file is loaded for the fisrt time there is no destroy function (that why there is try{}
           */
          document.getElementById("content_element").innerHTML = GlobalDefinition.CONTENT_WAITING_PAGE;
          document.getElementById("content_header").innerHTML = "";
        }

        function loadedContent(file_name_script) {
          number_content_loaded = number_content_loaded + 1;
          if (number_content_loaded == number_content_to_load) {
            //wait for all content to load before loading script
            loadMaiScript(GlobalDefinition.AJAX_JAVASCRIPT_TAG + file_name_script);
            number_content_loaded = 0;
          }

        }


        function loadMainContent(file_name_div_content = "", file_name_header_content = "", file_name_script = "") {
          reset();

          number_content_to_load = 0;
          number_content_loaded = 0;
          if (file_name_div_content != "") {
            number_content_to_load = number_content_to_load + 1;
          }
          if (file_name_header_content != "") {
            number_content_to_load = number_content_to_load + 1;
          }

          if (file_name_div_content != "") {
            $("#content_element").load(GlobalDefinition.AJAX_HTML_CONTENT + file_name_div_content, function() {
              loadedContent(file_name_script);
            });
          }
          if (file_name_header_content != "") {
            $("#content_header").load(GlobalDefinition.AJAX_HTML_CONTENT + file_name_header_content, function() {
              loadedContent(file_name_script);
            });
          }
        }


        function doorClick() {
          loadMainContent(GlobalDefinition.FILE_NAME_DOOR_HTML_CONTENT,
            GlobalDefinition.FILE_NAME_HEADER_DOOR_HTML_CONTENT,
            GlobalDefinition.FILE_NAME_DOOR_SCRIPT);
        }

        function schoolOfficeClick() {
          loadMainContent("",
            GlobalDefinition.FILE_NAME_HEARDER_TOOLBAR_SCHOOL_OFFICE_HTML_CONTENT,
            GlobalDefinition.FILE_NAME_TOOLBAR_SCHOOL_OFFICE_SCRIPT);
        }

        function settingsClick() {
            loadMainContent("",
            GlobalDefinition.FILE_NAME_HEARDER_TOOLBAR_SETTINGS_HTML_CONTENT,
            GlobalDefinition.FILE_NAME_TOOLBAR_SETTINGS_SCRIPT);
        }


        function setChange(response) {
          try {
            var data = JSON.parse(response);
          } catch (e) {
            return;
          }

          switch (data[GlobalDefinition.REQUEST_OBJECT_TAG]) {
            case GlobalDefinition.REQUEST_DISCONNECTION_FROM_SESSION:
              {
                if (data[GlobalDefinition.REQUEST_RESULT_DISCONNECTION_FROM_SESSION]) 
				{
                  current_session_info = "";
                  document.getElementById("display_session_info_span").innerText = "";
                  location.reload();
                }
              }
              break;
            case GlobalDefinition.REQUEST_CHECK_IF_SESSION_IS_OPENED:
              { //previous session is still opened
                if (data[GlobalDefinition.REQUEST_RESULT_CHECK_IF_SESSION_IS_OPENED]) {
                  var last_name = data[GlobalDefinition.REQUEST_AGENT_LAST_NAME];
                  var first_name = data[GlobalDefinition.REQUEST_AGENT_FIRST_NAME];
                  var job = data[GlobalDefinition.REQUEST_AGENT_JOB];

                  document.getElementById("display_session_info_span").innerText = DataRequest.getFormatedSessionInfo(last_name, first_name, job);

                  schoolOfficeClick();

                } else { //connection page
                  loadMainContent(GlobalDefinition.FILE_NAME_CONNECTION_HTML_CONTENT,
                    "",
                    GlobalDefinition.FILE_NAME_CONNECTION_SCRIPT);
                }
              }
              break;
          }

        }



        return { //all those function are available outside the module

          initialize: function() {
            document.getElementById("school_office_image").setAttribute("src", GlobalDefinition.AJAX_IMAGE + GlobalDefinition.SCHOOL_OFFICE_IMAGE);
            document.getElementById("door_image").setAttribute("src", GlobalDefinition.AJAX_IMAGE + GlobalDefinition.DOOR_IMAGE);
            document.getElementById("settings_image").setAttribute("src", GlobalDefinition.AJAX_IMAGE + GlobalDefinition.SETTINGS_IMAGE);

            document.getElementById("display_session_info_span").addEventListener("mouseover", disconnectionArrayMouseOver);
            document.getElementById("display_session_info_span").addEventListener("mouseout", disconnectionArrayMouseOut);
            document.getElementById("display_session_info_span").addEventListener("click", disconnectionArrayClick);


            document.getElementById("door_item").addEventListener("click", doorClick);
            document.getElementById("schoolOfice_item").addEventListener("click", schoolOfficeClick);
            document.getElementById("settings_item").addEventListener("click", settingsClick);


            DataRequest.sendPostRequest(DataRequest.setCheckIfSessionOpened(), setChange);
			
			$( document ).ajaxError(function( e, xhr, settings, thrownError ) 
			{
					if(xhr.status==401)//UNAUTHORIZED
					{
						var message = "Le système a rejeté votre requête car vos informations d'authentification ne sont pas valides"
									  +"\nActualiser la page ?";
						if (confirm(message)) //ask if user want to reload the page
						{
							location.reload();
						}
						
						document.getElementById("content_element").innerHTML="";
					}
			});

          },

          clickOnDoorIcon: function() {
            doorClick();
          },

          clickOnSchoolOfficeIcon: function() {
            schoolOfficeClick();
          },

          clickOnSettingsIcon: function() {
            settingsClick();
          },

        };
      })();
  </script>
  <label class="menu-gwd-img-1lld"></label>;
  <div class="menu-gwd-div-eeuw" id="groupBox_ruban">
    <div style="cursor: pointer" id="door_item">
      <img class="menu-gwd-img-77n8" id="door_image"/>
      <span class="main-font-theme menu-gwd-span-v8zs menu-gwd-span-wiou1 menu-gwd-span-1k1n menu-gwd-span-unrd">PORTE</span>
    </div>
    <div style="cursor: pointer" id="schoolOfice_item">
      <img class="menu-gwd-img-1hc6" id="school_office_image"/>
      <span class="main-font-theme menu-gwd-span-v8zs menu-gwd-span-wiou1 menu-gwd-span-1k1n menu-gwd-span-1sbk">VIE SCOLAIRE</span>
    </div>
    <div style="cursor: pointer" id="settings_item">
      <img class="menu-gwd-img-1g2x" id="settings_image"/>
    </div>
  </div>
  <div class="menu-gwd-div-i075" id="content_element">
  </div>
  <div class="gwd-div-1b4f" id="content_header"></div>
  <span class="main-font-theme gwd-div-1our" id="display_session_info_span"></span>
</body>

</html>